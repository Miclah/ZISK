@page "/login"
@layout LoginLayout
@using ZISK.Client.Models

<MudContainer MaxWidth="MaxWidth.Small" Class="d-flex align-center justify-center" Style="height: 100vh;">
    <MudCard Elevation="4" Class="pa-8" Style="width: 100%;">
        <MudCardHeader>
            <MudText Typo="Typo.h4" Align="Align.Center">Prihlásenie</MudText>
        </MudCardHeader>
        <MudCardContent>
            <EditForm Model="@loginModel" OnValidSubmit="HandleLogin">
                <DataAnnotationsValidator />
                
                <MudTextField @bind-Value="loginModel.Username"
                              Label="Meno"
                              Variant="Variant.Outlined"
                              Class="mb-4"
                              For="@(() => loginModel.Username)" />

                <MudTextField @bind-Value="loginModel.Password"
                              Label="Heslo"
                              Variant="Variant.Outlined"
                              InputType="InputType.Password"
                              Class="mb-4"
                              For="@(() => loginModel.Password)" />

                @if (!string.IsNullOrEmpty(errorMessage))
                {
                    <MudAlert Severity="Severity.Error" Class="mb-4">@errorMessage</MudAlert>
                }

                <MudButton ButtonType="ButtonType.Submit"
                           Variant="Variant.Filled"
                           Color="Color.Primary"
                           FullWidth="true"
                           Disabled="@isLoading">
                    @if (isLoading)
                    {
                        <MudProgressCircular Size="Size.Small" Indeterminate="true" Class="mr-2" />
                    }
                    Prihlásiť sa
                </MudButton>
            </EditForm>
        </MudCardContent>
    </MudCard>
</MudContainer>

@code {
    private LoginModel loginModel = new();
    private string? errorMessage;
    private bool isLoading;

    private async Task HandleLogin()
    {
        isLoading = true;
        errorMessage = null;

        isLoading = false;
    }
}